import{r as f,u as w,j as r}from"./index--oy4d1LN.js";import{u as q}from"./useMutation-BWXDtBTP.js";import{c as N}from"./board-CNwfHsRh.js";import{u as U}from"./Markdown-Cpgij77q.js";import{d as F}from"./index-BMmima0Q.js";const i={"write-container":"_write-container_1ry5q_1","write-title":"_write-title_1ry5q_21","write-form":"_write-form_1ry5q_37","input-title":"_input-title_1ry5q_107","input-content":"_input-content_1ry5q_119","file-button":"_file-button_1ry5q_155","file-input":"_file-input_1ry5q_195","file-list":"_file-list_1ry5q_203","file-item":"_file-item_1ry5q_213","remove-button":"_remove-button_1ry5q_233","submit-button":"_submit-button_1ry5q_249","error-message":"_error-message_1ry5q_285","input-error":"_input-error_1ry5q_297","editor-error-container":"_editor-error-container_1ry5q_305","editor-container":"_editor-container_1ry5q_319","file-comment":"_file-comment_1ry5q_327"};function I({category:_}){const[a,c]=f.useState(null),[n,m]=f.useState({}),p=w(),[s,u]=f.useState({title:"",content:"",category:_,imageUrls:[]}),{editorRef:d,editorConfig:g}=U({onContentChange:t=>{u(e=>({...e,content:t})),t.trim()&&m(e=>({...e,content:void 0}))}}),h=q({mutationFn:async()=>{const t=d.current.getInstance().getMarkdown(),e=a||null,o={board:{title:s.title,content:t,category:s.category,imageUrls:s.imageUrls,resUserDetailDto:{name:"사용자 이름",email:"user@example.com",studentId:12345678,term:"2025-1",githubId:"githubUsername",imgUrl:"https://example.com/profile.jpg"}},file:e?[e.name]:[]};return console.log(o.board),await N({...o.board,likes:0,liked:!1},e)},onSuccess:async()=>{alert("게시글 작성 성공"),await p(-1),setTimeout(()=>{window.scrollTo(0,0)},100),u({title:"",content:"",category:_,imageUrls:[]}),c(null)},onError:t=>{console.error("게시글 작성 실패:",t),alert("게시글 작성 실패")}}),y=()=>{var l;const t={};let e=!0;return s.title.trim()||(t.title="제목을 입력해주세요.",e=!1),(((l=d.current)==null?void 0:l.getInstance().getMarkdown())||"").trim()||(t.content="내용을 입력해주세요.",e=!1),m(t),e},b=t=>{const{name:e,value:o}=t.target;u(l=>({...l,[e]:e==="imageUrls"?o.split(","):o})),n[e]&&m(l=>({...l,[e]:void 0}))},x=t=>{t.target.files&&t.target.files.length>0&&c(t.target.files[0])},j=()=>{c(null)},v=async t=>{t.preventDefault(),y()&&h.mutate()};return r.jsx("div",{className:i["write-container"],children:r.jsxs("form",{className:i["write-form"],onSubmit:v,children:[r.jsx("h2",{className:i["write-title"],children:"글쓰기"}),r.jsx("label",{htmlFor:"title",children:"제목"}),r.jsx("input",{className:`${i["input-title"]} ${n.title?i["input-error"]:""}`,type:"text",id:"title",name:"title",placeholder:"제목을 입력하세요.",value:s.title,onChange:b}),n.title&&r.jsx("p",{className:i["error-message"],children:n.title}),r.jsx("label",{htmlFor:"content",children:"내용"}),r.jsx("div",{className:`${i["editor-container"]} ${n.content?i["editor-error-container"]:""}`,children:r.jsx(F,{ref:d,...g})}),n.content&&r.jsx("p",{className:i["error-message"],children:n.content}),r.jsx("label",{className:i["file-button"],htmlFor:"fileUpload",children:"파일 선택"}),r.jsx("input",{className:i["file-input"],type:"file",id:"fileUpload",onChange:x}),a&&r.jsxs("div",{className:i["file-item"],children:[a.name,r.jsx("button",{type:"button",className:i["remove-button"],onClick:j,children:"✕"})]}),r.jsx("div",{className:i["file-comment"],children:"파일 업로드는 한 개만 가능합니다!"}),r.jsx("input",{className:i["submit-button"],type:"submit",value:"게시글 작성"})]})})}export{I as B};
