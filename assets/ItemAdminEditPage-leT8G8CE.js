import{u as v,r as u,j as e}from"./index--oy4d1LN.js";import{u as E,Q as I}from"./queryKey-C4OvowHP.js";import{u as S}from"./useMutation-BWXDtBTP.js";import{u as w,a as B}from"./item-CqJ6QjA0.js";import{o as F}from"./board-CNwfHsRh.js";import{s as C}from"./Project.module-Dpi1qAxQ.js";import"./utils-km2FGkQ4.js";function N(){const x=v(),[s,i]=u.useState({name:"",description:"",itemCategory:0,imageUrl:"",isBorrowed:!0}),c=window.location.href,p=c.substring(c.lastIndexOf("/")+1),l=Number(p),r=E({queryKey:I.item.itemById(l),queryFn:async()=>B(l)});let n;const h=S({mutationFn:t=>w(t),onSuccess:async()=>{alert("수정 성공"),await x(-1)},onError:t=>{console.error("수정 실패:",t),alert("수정 실패")}});u.useEffect(()=>{r.isSuccess&&r.data&&i(t=>({...t,...r.data}))},[r.isSuccess,r.data]);const a=async t=>{const{name:m,value:f,type:g,files:o}=t.target;if(g==="checkbox"&&t.target instanceof HTMLInputElement)i({...s,[m]:t.target.checked});else if(o&&o[0]){const b=o[0],d=await F(b);d&&i(y=>({...y,imageUrl:d}))}else i({...s,[m]:f})},j=t=>{t.preventDefault(),h.mutate(s)};if(r.isLoading)n=e.jsx("div",{className:"loading",children:"데이터를 불러오는 중입니다..."});else if(r.isError)n=e.jsx("div",{className:"error",children:"에러가 발생했습니다!"});else if(r.isSuccess)return console.log(s),e.jsx("div",{className:C.container,children:e.jsxs("form",{onSubmit:j,children:[e.jsx("h1",{children:"비품 게시글 수정"}),e.jsx("label",{htmlFor:"Name",children:"제품명"}),e.jsx("br",{}),e.jsx("input",{type:"text",id:"name",name:"name",placeholder:"제품명 입력",value:s.name,onChange:a,required:!0}),e.jsx("br",{}),e.jsx("label",{htmlFor:"description",children:"설명"}),e.jsx("br",{}),e.jsx("input",{type:"text",id:"description",name:"description",placeholder:"설명 입력",value:s.description,onChange:a,required:!0}),e.jsx("br",{}),e.jsx("label",{htmlFor:"imageSelect",children:"이미지 선택"}),e.jsx("br",{}),e.jsx("input",{type:"file",id:"imageSelect",name:"imageSelect",accept:"image/*",onChange:a}),e.jsx("br",{}),e.jsx("br",{}),e.jsx("label",{htmlFor:"isBorrowed",children:"대여 불가능"}),e.jsx("br",{}),e.jsx("input",{type:"checkbox",id:"isBorrowed",name:"isBorrowed",checked:s.isBorrowed,onChange:a}),e.jsx("br",{}),e.jsx("input",{type:"submit",value:"프로젝트 수정"})]})});return e.jsx("div",{children:n})}function K(){return e.jsx("div",{children:e.jsx(N,{})})}export{K as default};
